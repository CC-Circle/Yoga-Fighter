# Yoga Fighter ğŸš€
# Yoga Fighter Continuous Integration (CI) GitHub Actions tests

name: Yoga Fighter CI
on:
  pull_request:
    branches: [main] # 'main' ãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒä½œæˆã•ã‚ŒãŸã¨ãã«ã€ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹

jobs:
  build:
    name: Run the macOS build (Apple Silicon) # ã‚¸ãƒ§ãƒ–å: macOS ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œï¼ˆApple Siliconï¼‰
    runs-on: ubuntu-latest # ã‚¸ãƒ§ãƒ–ãŒå®Ÿè¡Œã•ã‚Œã‚‹ç’°å¢ƒ: æœ€æ–°ã® Ubuntu

    steps:
      # actions/checkout@v4 ã‚’åˆ©ç”¨ã—ã¦ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«
      # Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä¸­èº«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã‚‹
      - name: Check out my unity project. # ã‚¹ãƒ†ãƒƒãƒ—å: Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4 # actions/checkout@v4 ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨
        with:
          lfs: true # å¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆLFSï¼‰ã‚’æœ‰åŠ¹ã«ã™ã‚‹

      # Cache
      - name: Cache # ã‚¹ãƒ†ãƒƒãƒ—å: ã‚­ãƒ£ãƒƒã‚·ãƒ¥
        uses: actions/cache@v4 # actions/cache@v4 ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨
        with:
          path: Library # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: Unity ã® Library ãƒ•ã‚©ãƒ«ãƒ€
          key: Library-${{ hashFiles('Assets/**', 'Packages/**', 'ProjectSettings/**') }} # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼: Assets, Packages, ProjectSettings ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚·ãƒ¥
          restore-keys: |
            Library- # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã«ä½¿ç”¨ã™ã‚‹å¾©å…ƒã‚­ãƒ¼ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹

      # Free up disk space
      - name: Free Disk Space # ã‚¹ãƒ†ãƒƒãƒ—å: ãƒ‡ã‚£ã‚¹ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®è§£æ”¾
        uses: jlumbroso/free-disk-space@main # jlumbroso/free-disk-space ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨
        with:
          tool-cache: false # ãƒ„ãƒ¼ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å‰Šé™¤ã‚’ç„¡åŠ¹ã«ã™ã‚‹

      # GameCI ã® Builder ã‚’åˆ©ç”¨ã—ã¦ã€
      # Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹
      - name: Run the macOS build (Apple Silicon) # ã‚¹ãƒ†ãƒƒãƒ—å: macOS ãƒ“ãƒ«ãƒ‰ã®å®Ÿè¡Œï¼ˆApple Siliconï¼‰
        uses: game-ci/unity-builder@v4 # game-ci/unity-builder@v4 ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨
        env:
          UNITY_LICENSE: ${{ secrets.UNITY_LICENSE }} # Unity ãƒ©ã‚¤ã‚»ãƒ³ã‚¹
          UNITY_EMAIL: ${{ secrets.UNITY_EMAIL }} # Unity ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
          UNITY_PASSWORD: ${{ secrets.UNITY_PASSWORD }} # Unity ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
        with:
          # ä»Šå›ã¯ macOS ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã„ãŸã„ãŸã‚ StandaloneOSX ã‚’æŒ‡å®šã™ã‚‹
          targetPlatform: StandaloneOSX # ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ : macOS
          unityVersion: 2022.3.23f1 # ä½¿ç”¨ã™ã‚‹ Unity ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³
          customParameters: -buildTarget StandaloneOSX -arch arm64 # ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: Apple Silicon ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æŒ‡å®š
